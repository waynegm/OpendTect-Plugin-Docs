<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Wayne Mogg">
        
        <link rel="shortcut icon" href="../../favicon-32x32.png">
        

	<title>Local polynomial approximation - OpendTect Plugins</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/juxtapose.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-62607269-1', 'OpendTect-Plugin-Docs');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">OpendTect Plugins</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../Installation/download-binary/">Download</a>
</li>

                    
                        
<li >
    <a href="../../Installation/installation/">Install</a>
</li>

                    
                        
<li >
    <a href="../../Installation/building-from-source/">Build from source</a>
</li>

                    
                        
<li >
    <a href="../../Installation/faq/">Issues/FAQ</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Plugins <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../Attributes/AVOAttrib/">AVO attributes</a>
</li>

                    
                        
<li >
    <a href="../../Attributes/ExternalAttrib/">External attributes</a>
</li>

                    
                        
<li >
    <a href="../../Attributes/GradientAttrib/">Gradient attribute</a>
</li>

                    
                        
<li >
    <a href="../../Attributes/LTFAttrib/">Local time-frequency attribute</a>
</li>

                    
                        
<li >
    <a href="../../Attributes/MLVFilter/">Mean of least variance filter</a>
</li>

                    
                        
<li >
    <a href="../../Attributes/RSpecAttrib/">Recursive time-frequency decomposition</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Attributes <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../ExternalAttributes/">Introduction</a>
</li>

                    
                        
<li >
    <a href="../AVO_IG/">AVO Intercept and Gradient</a>
</li>

                    
                        
<li >
    <a href="../DipandAzimuth/">Dip and Azimuth</a>
</li>

                    
                        
<li >
    <a href="../LPA_Smooth/">LPA Smoothing</a>
</li>

                    
                        
<li class="active">
    <a href="./">Local polynomial approximation</a>
</li>

                    
                        
<li >
    <a href="../Spatial_Filter_Circular/">Spatial filter - Circular</a>
</li>

                    
                        
<li >
    <a href="../Spatial_Filter_Rectangular/">Spatial filter - Rectangular</a>
</li>

                    
                        
<li >
    <a href="../Vector_Filters/">Vector Filters</a>
</li>

                    
                        
<li >
    <a href="../Z_Delay_Est/">Z Delay Estimation</a>
</li>

                    
                        
<li >
    <a href="../ZC_Block/">Zero crossing trace block</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../license/">License</a>
</li>

                    
                        
<li >
    <a href="../../relnotes/">Release notes</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../LPA_Smooth/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../Spatial_Filter_Circular/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/waynegm/OpendTect-Plugins">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#local-polynomial-approximation">Local Polynomial Approximation</a></li>
        
            <li><a href="#description">Description</a></li>
        
            <li><a href="#input-parameters">Input Parameters</a></li>
        
            <li><a href="#lpa-dip">LPA Dip</a></li>
        
            <li><a href="#lpa-coefficients">LPA Coefficients</a></li>
        
            <li><a href="#lpa-eigenvalues">LPA Eigenvalues</a></li>
        
            <li><a href="#lpa-eigenvectors">LPA Eigenvectors</a></li>
        
            <li><a href="#references">References</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="local-polynomial-approximation">Local Polynomial Approximation</h1>
<h2 id="description">Description</h2>
<p>This series of External Attributes are based around fitting a second order 3D polynomial to a region of data around each sample location using gaussian weighted least squares. For regularly sampled data the fit can be calculated very efficiently by convolution. </p>
<p>The approximation has the following form:</p>
<p>\[
    r_0 + r_1*x + r_2*y + r_3*z + r_4*x^2 + r_5*y^2 +r_6*z^2 + r_7*x*y + r_8*x*z + r_9*y*z
\]</p>
<p>where x (inline), y (crossline) and z (time/depth) are relative to the analysis location, ie the analysis location has x=y=z=0.</p>
<h2 id="input-parameters">Input Parameters</h2>
<p>All attributes have the same set of input parameters. The only difference is that some have a choice of output attribute.</p>
<p><img alt="Input Parameters" src="../../images/lpa_smooth_inputpar.jpg" title="LPA external attribute input parameters" /></p>
<table>
<thead>
<tr>
<th>NAME</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>Z window (+/-samples)</td>
<td>Specifies the extent of the analysis cube in the Z direction. Number of Z samples in cube will be 2*Z_window+1.{: style="width:60%"}</td>
</tr>
<tr>
<td>Stepout</td>
<td>Specifies the inline and crossline extent of the analysis cube. Number of samples in each direction will be 2*Stepout+1.</td>
</tr>
<tr>
<td>Weight Factor</td>
<td>Determines the extent of the gaussian weight function used in the weighted least squares approximation.  The standard deviation of the gaussian weight function (<strong>sigma</strong>) is related to this value by <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>sigma = min(2*Stepout, 2*Z_Window) * Weight_Factor</strong>.<br/> A value of 0.15 gives near zero weight for points at the smallest extent of the analysis cube.</td>
</tr>
</tbody>
</table>
<h2 id="lpa-dip">LPA Dip</h2>
<p>This attribute (<strong>ex_lpa_dip.py</strong>) uses the local polynomial approximation coefficients to estimate an orientation tensor as per <a href="http://dx.doi.org/10.1190/geo2012-0427.1" title="Farnebäck, Gunnar. Polynomial Expansion for Orientation and Motion Estimation. Linköping Studies in Science and Technology. Dissertations No, 790">Farnebäck (2002)</a> and assumes the orientation of the first eigenvector is normal to the local event dip. Output can be either the inline or crossline dip. The units are millseconds per meter for time data and millimetres per metre for depth data.  Only <a href="http://numba.pydata.org/">Numba JIT compiler</a> versions of this attribute are provided.</p>
<p>There are two versions of the attribute:</p>
<ul>
<li><strong>ex_lpa_dip_raw.py</strong> which does not include any post processing of the computed dips. The output will include a lot of steep non-geologic dips whenever an event ends. These spurious dips can generally be removed by applying a median filter (as per the example below).</li>
<li><strong>ex_lpa_dip.py</strong> which includes dip processing comprising removal of dips beyond a user specified limit and a low pass filter along the Z direction.</li>
</ul>
<p>The example on the left shows inline dip on a crossline from a PSDM volume calculated by <strong>ex_lpa_dip_raw.py</strong> using a 5x5x5 sample volume (Zwindow: 2, Stepout: 2,2) with a subsequent 3x3x3 sample median filter applied to remove spurious dips. The image on the right shows the output of <strong>ex_lpa_dip.py</strong> for the same sample volume with a dip range limit of +/-1200 mm/m. </p>
<div class="juxtapose" style="margin:0px;padding:0px" data-startingposition="50" data-showlabels="true" data-showcredits="false" data-animate="false" data-mode="horizontal">
<img src="../../images/lpa_dip_raw_med_2x2x2.jpg" data-label="lpa_dip_raw 2x2x2 + median filter" data-credit="">
<img src="../../images/lpa_dip_2x2x2.jpg"  data-label="lpa_dip 2x2x2" data-credit="">
</div>

<h2 id="lpa-coefficients">LPA Coefficients</h2>
<p>This attribute (<strong>ex_lpa_coef.py</strong>) outputs all of the local polynomial approximation coefficients. The r0 output is identical to the LPA Smoothing attribute. Only a <a href="http://numba.pydata.org/">Numba JIT compiler</a> version of this attribute is provided. The example below shows the inline first and second derivative components on a crossline.</p>
<div class="juxtapose" style="margin:0px;padding:0px" data-startingposition="50" data-showlabels="true" data-showcredits="false" data-animate="false" data-mode="horizontal">
<img src="../../images/lpa_coef_r1_2x2x2.jpg" data-label="lpa inline gradient" data-credit="">
<img src="../../images/lpa_coef_r4_2x2x2.jpg"  data-label="lpa inline 2nd derivative" data-credit="">
</div>

<h2 id="lpa-eigenvalues">LPA Eigenvalues</h2>
<p>This attribute (<strong>ex_lpa_eigenvals.py</strong>) uses the local polynomial approximation coefficients to estimate an orientation tensor as per <a href="http://dx.doi.org/10.1190/geo2012-0427.1" title="Farnebäck, Gunnar. Polynomial Expansion for Orientation and Motion Estimation. Linköping Studies in Science and Technology. Dissertations No, 790">Farnebäck (2002)</a>. Output are the eigenvalues (e1, e2, e3) of the tensor in descending order. Only a <a href="http://numba.pydata.org/">Numba JIT compiler</a> version of this attribute is provided. The example below shows the first (left image) and second (right image) eigenvalues on a crossline.</p>
<div class="juxtapose" style="margin:0px;padding:0px" data-startingposition="50" data-showlabels="true" data-showcredits="false" data-animate="false" data-mode="horizontal">
<img src="../../images/lpa_eigval_1_2x2x2.jpg" data-label="lpa 1st eigenvalue" data-credit="">
<img src="../../images/lpa_eigval_2_2x2x2.jpg"  data-label="lpa 2nd eignevalue" data-credit="">
</div>

<h2 id="lpa-eigenvectors">LPA Eigenvectors</h2>
<p>This attribute (<strong>ex_lpa_eigenvec.py</strong>) uses the local polynomial approximation coefficients to estimate an orientation tensor as per <a href="http://dx.doi.org/10.1190/geo2012-0427.1" title="Farnebäck, Gunnar. Polynomial Expansion for Orientation and Motion Estimation. Linköping Studies in Science and Technology. Dissertations No, 790">Farnebäck (2002)</a>. Output are the eigenvectors (t1x,t1y,t1z,t2x,t2y,t2z,t3x,t3y,t3z) of the tensor. Eigenvector [t1x, t1y t1z] corresponds to the first eigenvalue, e1 etc. Only a <a href="http://numba.pydata.org/">Numba JIT compiler</a> version of this attribute is provided. The example below shows the y-component (left image) and z-component (right image) of the first eigenvector, ie t1y and t1z.</p>
<div class="juxtapose" style="margin:0px;padding:0px" data-startingposition="50" data-showlabels="true" data-showcredits="false" data-animate="false" data-mode="horizontal">
<img src="../../images/lpa_eigvec_t1y_2x2x2.jpg" data-label="lpa t1y" data-credit="">
<img src="../../images/lpa_eigvec_t1z_2x2x2.jpg"  data-label="lpa t1z" data-credit="">
</div>

<h2 id="references">References</h2>
<p><a href="http://www.doc.ic.ac.uk/research/technicalreports/2006/DTR06-8.pdf">Anisotropic Multidimensional Savitzky Golay kernels for Smoothing, Differentiation and Reconstruction</a></p>
<p><a href="http://www.diva-portal.org/smash/get/diva2:302485/FULLTEXT01.pdf">Polynomial Expansion for Orientation and Motion Estimation</a></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>All content and images &copy; 2015 by Wayne Mogg</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/juxtapose.min.js"></script>
        <script src="../../js/mathjax-config.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>